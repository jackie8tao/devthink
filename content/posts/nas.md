---
title: Nas折腾记
date: 2023-05-28T23:05:03+08:00
draft: true
tags:
  - nas
categories:
  - nas
---

NAS(Network Attached Storage)是一种存储设备，它连接到局域网中的路由器或交换机，允许多台计算机同时访问和共享存储空间。
NAS设备通常运行专用操作系统，提供文件共享、数据备份、远程访问等功能。
它们还可以作为媒体服务器，通过 DLNA 或其他协议将音频、视频和图片共享到网络中的其他设备。

人们搭建NAS通常是为了集中存储和管理家庭或办公室中的数据，以便多台计算机或设备可以访问和共享这些数据。
此外，NAS还可以提供数据备份、远程访问和媒体共享等功能，使用户能够随时随地访问自己的数据。
相比于传统的外部硬盘或USB存储设备，NAS具有更高的可靠性和扩展性，可以满足用户不断增长的存储需求。

常见的搭建NAS的方案包括以下几种：

  1. 购买专用NAS设备：市面上有许多厂商提供各种规格和价格的NAS设备，用户只需要购买合适的设备并按照说明书进行设置即可。
  2. 将旧电脑改造成NAS：用户可以使用旧电脑，安装专门的NAS操作系统，如FreeNAS、OpenMediaVault等，将其转变为功能强大的NAS设备。
  3. 使用路由器自带的USB接口：一些路由器提供了USB接口，用户可以将外部硬盘或U盘连接到路由器上，通过路由器提供的NAS功能实现文件共享和远程访问。
  4. 使用云存储服务：用户可以使用云存储服务，如Dropbox、Google Drive、OneDrive等，将数据存储在云端，并通过客户端软件或Web界面访问和共享数据。

本文介绍将旧设备改造为NAS设备，实现数据存储、家庭影院和个人办公等功能。

## 旧设备介绍

- CPU: 4 x Intel(R) Core(TM) i5-7500 CPU @ 3.40GHz
- 内存: DDR4 8G X 2
- 主板: ASUS PRIME B250M-K
- 硬盘: 6X16T、2X14T
- 独显: GTX 1050Ti

## 系统搭建思路

NAS系统搭建分为两种思路，一种直接将NAS系统安装到裸机中，另一种则借助虚拟化系统，将NAS系统安装到虚拟化系统中。
个人使用的是第二种思路，裸机安装[PVE](https://www.proxmox.com/en/)，然后借助PVE的虚拟化功能安装[TrueNAS Scale](https://www.truenas.com/truenas-scale/)。
该方案有以下几种好处：

- 裸机安装PVE，将应用安装到虚拟系统中，实现了NAS系统和平台的隔离，保证了系统的稳定性，避免因为NAS系统的各种问题导致系统奔溃，需要反复折腾宿主机的情况。
- 借助PVE的便捷性，可以方便的安装各种系统和应用，不用仅仅依赖于NAS系统的功能，提升了应用的扩展性。

### PVE系统安装

1. 下载系统镜像，[PVE7.4](https://enterprise.proxmox.com/iso/proxmox-ve_7.4-1.iso)。
2. 利用Rufus将系统刻录进U盘中。
3. 通过U盘安装PVE系统到物理机中（安装的过程中，建议保证网络联通，可以直接设置PVE系统的ip地址）。
